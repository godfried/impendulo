{{define "analysis"}}
{{$currentFile := .childFile}}
{{$currentResult := .currentChildResult}}
{{$nextResult := .nextChildResult}}
{{$fileName := .ctx.Browse.ChildFile}}
{{$current := .ctx.Browse.CurrentChild}}
{{$childFiles := .childFiles}}
{{$sid := .ctx.Browse.Sid}}
{{$lang := submissionLang $sid}} 
{{$testResults := .childResults}}
<h4 class="text-center code-popover-h" >
  <small>tool</small> {{.ctx.Browse.Result}}
  <a href="#code_wrapper" id="codepopoverlink">
    {{$fileName}}
  </a>
  @ {{date $currentFile.Time}}
</h4>
<div id="code_wrapper" class="popover-code hidden">
  <pre class="brush: {{$lang}}; class-name: 'popover-code'">
    {{string $currentFile.Data}}
  </pre>
</div>
<script type="text/javascript">
  highlight(undefined);
  addPopover('codepopoverlink', 'code_wrapper');
</script>
<div id="chart" class="chart" xmlns:xlink="http://www.w3.org/1999/xlink">
  <div id="chart-tooltip" class="tooltip"></div>
</div>
<script>
  {{$tc := chartTime (index .files .ctx.Browse.Current)}}
  {{$tn := chartTime (index .files .ctx.Browse.Next)}}
  ajaxChart({{.ctx.Browse.Sid.Hex}},{{.ctx.Browse.File}},{{.ctx.Browse.Result}},{{$tc}},{{$tn}},{{$currentFile.Id.Hex}});
</script>
{{$sliced := slice $childFiles $current}}
{{$adjustment := adjustment $childFiles $current}}
<div id="wrapper" style="text-align: center">    
  <ul id="filepager" class="pagination pagination-centre">
    <li>
      <a href="displaychildresult?currentchild={{(sum $current -1)}}">
	&laquo;
      </a>
    </li>
    {{range $index, $file := $sliced}}
    {{$actual := sum $index $adjustment}}
    {{$actualNext := sum $actual 1}}
    {{if eq $actual $current}} 
    <li class="active">
      <a id="file{{$actual}}"
	 href="displaychildresult?currentchild={{$actual}}">
	{{$actualNext}}
      </a>
    </li>
    {{else}}
    <li>
      <a id="file{{$actual}}"
	 href="displaychildresult?currentchild={{$actual}}">
	{{$actualNext}}
      </a>
    </li>
    {{end}}
    {{end}}
    <li>
      <a href="displaychildresult?currentchild=(sum $current 1)}}">
	&raquo;
      </a>
    </li>
  </ul>
</div>
<div class="row">
  {{$args := args "state" .ctx.Browse}}
  <div class="col-md-6">
    {{if isError $currentResult}}
    <p class="text-danger">{{$currentResult.GetReport}}</p>
    {{else}}
    {{$args := insert $args "Report" $currentResult.GetReport}}
    {{template "result"  $args}}
    {{end}}
  </div>
  <div class="col-md-6">
    {{if isError $nextResult}}
    <p class="text-danger">{{$nextResult.GetReport}}</p>
    {{else}}
    {{$args := insert $args "Report" $nextResult.GetReport}}
    {{template "result"  $args}}
    {{end}}
  </div>
</div>
{{end}}

