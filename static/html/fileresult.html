{{define "view"}}
{{$project := projectName .ctx.Browse.Pid}}
{{$uid := .ctx.Browse.Uid}}
{{$sid := .ctx.Browse.Sid}}
{{$pid := .ctx.Browse.Pid}}
{{template "breadcrumb" .}}
<h2 class="text-center"><small>user</small> {{.ctx.Browse.Uid}} <br>
  <small>project</small> {{$project}}</h2>
<ul class="list-unstyled">
  {{range .fileInfo}}
  {{$fileName := .Name}}
  <li>
    <h3>{{$fileName}}</h3>
    <h5>{{.Count}} Snapshots</h5>
    <ul class="list-inline">
      <li class="dropdown">
	<button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
	  Analysis <span class="caret"></span>
	</button>
	{{$results := resultNames $sid $fileName}}
	<ul class="dropdown-menu" role="menu">
	  {{range $k, $v := $results}}  
	  {{if emptyM $v}}
	  <li>
	    <a href="displayresult?result={{$k}}&file={{$fileName}}">
	      {{$k}}
	    </a>
	  </li>
	  {{else}}
	  <li class="dropdown-submenu">
	    <a tabindex="-1" href="#">{{$k}}</a>
	    <ul class="dropdown-menu" role="menu">
	      {{range $k2, $v2 := $v}}  
	      {{if emptyS $v2}}
	      <li>
		<a href="displayresult?result={{$k}}:{{$k2}}&file={{$fileName}}">
		  {{$k2}}
		</a>
	      </li>
	      {{else}}
	      <li class="dropdown-submenu">
		<a tabindex="-1" href="#">{{$k2}}</a>
		<ul class="dropdown-menu" role="menu">
		  {{$files := sortFiles $v2}}
		  {{range $files}}
		  <li>
		    <a href="displayresult?result={{$k}}:{{$k2}}-{{.Id.Hex}}&file={{$fileName}}">
		      {{date .Time}}
		    </a>
		  </li>
	      	  {{end}}
		</ul>
	      </li>
	      {{end}}
	      {{end}}
	    </ul>
	  </li>
	  {{end}}
	  {{end}}
	</ul>
      </li>
    </ul>
  </li>
  {{end}}
</ul>
{{end}}
